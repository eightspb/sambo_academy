# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–µ–ø–ª–æ—é Sambo Academy –Ω–∞ VPS

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- VPS —Å Ubuntu 20.04/22.04
- SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É
- Git —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ
- Docker –∏ Docker Compose –±—É–¥—É—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## üîß –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –¥–µ–ø–ª–æ—é

### –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env.production

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `.env.production`
2. **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∏–∑–º–µ–Ω–∏—Ç–µ:**

```bash
# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á:
openssl rand -hex 32

# –í—Å—Ç–∞–≤–∏—Ç—å –≤ .env.production:
SECRET_KEY=–≤–∞—à_—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π_–∫–ª—é—á_32_—Å–∏–º–≤–æ–ª–∞

# –ü—Ä–∏–¥—É–º–∞—Ç—å –Ω–∞–¥–µ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å –¥–ª—è –ë–î:
POSTGRES_PASSWORD=–≤–∞—à_–Ω–∞–¥–µ–∂–Ω—ã–π_–ø–∞—Ä–æ–ª—å
DATABASE_URL=postgresql+asyncpg://sambo_user:–≤–∞—à_–Ω–∞–¥–µ–∂–Ω—ã–π_–ø–∞—Ä–æ–ª—å@localhost:5432/sambo_academy
```

3. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —É–∫–∞–∂–∏—Ç–µ –¥–æ–º–µ–Ω
```bash
DOMAIN=your-domain.com
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î

```bash
# –°–æ–∑–¥–∞—Ç—å –¥–∞–º–ø —Ç–µ–∫—É—â–µ–π –ë–î
bash scripts/backup_db.sh
```

–î–∞–º–ø –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ `backups/sambo_academy_backup_YYYYMMDD_HHMMSS.sql`

## üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π

### –ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π (—Å –Ω—É–ª—è)

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è
bash scripts/deploy.sh

# –í—ã–±—Ä–∞—Ç—å: 1) –ü–æ–ª–Ω—ã–π –¥–µ–ø–ª–æ–π (–ø–µ—Ä–≤—ã–π —Ä–∞–∑)
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. ‚úÖ –°–æ–∑–¥–∞—Å—Ç –±—ç–∫–∞–ø –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
2. ‚úÖ –ü–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ VPS
3. ‚úÖ –ö–ª–æ–Ω–∏—Ä—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
4. ‚úÖ –ó–∞–≥—Ä—É–∑–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (.env.production)
5. ‚úÖ –ó–∞–≥—Ä—É–∑–∏—Ç –¥–∞–º–ø –ë–î
6. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
7. ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç –ë–î –∏–∑ –¥–∞–º–ø–∞
8. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
bash scripts/deploy.sh
```

–î–æ—Å—Ç—É–ø–Ω—ã–µ –æ–ø—Ü–∏–∏:
- **1) –ü–æ–ª–Ω—ã–π –¥–µ–ø–ª–æ–π** - –ø–µ—Ä–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
- **2) –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥** - –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **3) –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ + –ë–î** - –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π –¥–∞–º–ø –ë–î
- **4) –¢–æ–ª—å–∫–æ –ë–î** - –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ –ë–î
- **5) –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å** - –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∏ —Å—Ç–∞—Ç—É—Å–∞

```bash
bash scripts/monitor.sh
```

–î–æ—Å—Ç—É–ø–Ω—ã–µ –æ–ø—Ü–∏–∏:
- **1) –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å–µ—Ä–≤–∏—Å–æ–≤
- **2) –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ FastAPI
- **3) –õ–æ–≥–∏ –ë–î** - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ PostgreSQL
- **4) –õ–æ–≥–∏ Nginx** - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
- **5) –†–µ—Å—É—Ä—Å—ã** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU/RAM/Disk
- **6) SSH** - –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –Ω–∞–ø—Ä—è–º—É—é

## üîß –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ VPS (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å VPS –≤—Ä—É—á–Ω—É—é:

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ VPS
ssh user@your-vps-ip

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
bash ~/sambo_academy/scripts/setup_vps.sh

# 3. –ü–µ—Ä–µ–ª–æ–≥–∏–Ω–∏—Ç—å—Å—è
exit
ssh user@your-vps-ip
```

## üåê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞ –∏ SSL

### –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ–º–µ–Ω:

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ DNS:**
   ```
   A –∑–∞–ø–∏—Å—å: your-domain.com ‚Üí IP –≤–∞—à–µ–≥–æ VPS
   ```

2. **–ò–∑–º–µ–Ω–∏—Ç–µ nginx –∫–æ–Ω—Ñ–∏–≥:**
   ```bash
   # –ù–∞ VPS
   nano ~/sambo_academy/nginx/conf.d/sambo.conf
   
   # –ó–∞–º–µ–Ω–∏—Ç–µ server_name _ –Ω–∞:
   server_name your-domain.com;
   ```

3. **–ü–æ–ª—É—á–∏—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç:**
   ```bash
   # –ù–∞ VPS
   cd ~/sambo_academy
   
   # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å certbot
   sudo apt-get install certbot python3-certbot-nginx
   
   # –ü–æ–ª—É—á–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
   sudo certbot --nginx -d your-domain.com
   ```

4. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å nginx:**
   ```bash
   docker compose -f docker-compose.production.yml restart nginx
   ```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–ò–∑–º–µ–Ω–∏—Ç–µ SSH –ø–∞—Ä–æ–ª—å –Ω–∞ VPS**
   ```bash
   passwd
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSH –∫–ª—é—á–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
   ```bash
   ssh-copy-id user@vps-ip
   ```

3. **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Å–∏—Å—Ç–µ–º—É**
   ```bash
   sudo apt-get update && sudo apt-get upgrade -y
   ```

4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –ë–î**
   ```bash
   # –î–æ–±–∞–≤–∏—Ç—å –≤ crontab –Ω–∞ VPS:
   0 2 * * * cd ~/sambo_academy && docker compose -f docker-compose.production.yml exec -T db pg_dump -U sambo_user sambo_academy > ~/backups/backup_$(date +\%Y\%m\%d).sql
   ```

## üìù –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –¥–µ–ø–ª–æ—è

```
sambo_academy/
‚îú‚îÄ‚îÄ .env.production              # Production –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å!)
‚îú‚îÄ‚îÄ docker-compose.production.yml # Docker Compose –¥–ª—è production
‚îú‚îÄ‚îÄ nginx/
‚îÇ   ‚îî‚îÄ‚îÄ conf.d/
‚îÇ       ‚îî‚îÄ‚îÄ sambo.conf           # Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ backup_db.sh             # –ë—ç–∫–∞–ø –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ deploy.sh                # –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è
‚îÇ   ‚îú‚îÄ‚îÄ monitor.sh               # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ VPS
‚îÇ   ‚îî‚îÄ‚îÄ setup_vps.sh             # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VPS
‚îî‚îÄ‚îÄ backups/                     # –î–∞–º–ø—ã –ë–î
```

## üÜò Troubleshooting

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
bash scripts/monitor.sh
# –í—ã–±—Ä–∞—Ç—å: 2) –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose -f docker-compose.production.yml ps

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
docker compose -f docker-compose.production.yml restart
```

### –ë–î –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –ë–î
bash scripts/monitor.sh
# –í—ã–±—Ä–∞—Ç—å: 3) –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ –ë–î

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
docker compose -f docker-compose.production.yml exec app env | grep DATABASE
```

### –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –ë–î

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ VPS
ssh user@vps-ip

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–º–ø
head ~/sambo_academy/backup.sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é
cd ~/sambo_academy
docker compose -f docker-compose.production.yml exec -T db psql -U sambo_user sambo_academy < backup.sql
```

## üìû –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î
docker compose -f docker-compose.production.yml exec db psql -U sambo_user sambo_academy

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker compose -f docker-compose.production.yml logs -f app

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ
docker compose -f docker-compose.production.yml restart

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ
docker compose -f docker-compose.production.yml down

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
docker compose -f docker-compose.production.yml up -d
```

## ‚úÖ Checklist –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω `.env.production` —Å –Ω–∞–¥–µ–∂–Ω—ã–º–∏ –ø–∞—Ä–æ–ª—è–º–∏
- [ ] –°–æ–∑–¥–∞–Ω –±—ç–∫–∞–ø –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
- [ ] SSH –¥–æ—Å—Ç—É–ø –∫ VPS —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] VPS –∏–º–µ–µ—Ç –º–∏–Ω–∏–º—É–º 1GB RAM
- [ ] –û—Ç–∫—Ä—ã—Ç—ã –ø–æ—Ä—Ç—ã 80 –∏ 443
- [ ] (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ù–∞—Å—Ç—Ä–æ–µ–Ω –¥–æ–º–µ–Ω
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ

---

**üéâ –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É –≤–∞—à–µ–≥–æ VPS!**

–ù–∞–ø—Ä–∏–º–µ—Ä: `http://193.42.124.51` –∏–ª–∏ `https://your-domain.com`
