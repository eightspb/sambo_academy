<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ - Sambo Academy</title>
    <link rel="manifest" href="/static/manifest.json">
    <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body>
    <!-- Header Component -->
    <div id="app-header"></div>
    
    <!-- Navigation Component -->
    <div id="app-nav"></div>
    
    <main class="container">
        <h1 class="mb-2">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h1>
        
        <!-- Subscription Prices -->
        <div class="card mb-2">
            <h2>üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤</h2>
            <p class="text-secondary mb-2">
                –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤. –≠—Ç–∏ —Ü–µ–Ω—ã –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤—ã—Ö –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤.
            </p>
            
            <form id="pricesForm">
                <h3 class="mb-1">üë® –°—Ç–∞—Ä—à–∏–µ –≥—Ä—É–ø–ø—ã</h3>
                <div class="grid grid-2 mb-2">
                    <div class="form-group">
                        <label class="form-label">–ê–±–æ–Ω–µ–º–µ–Ω—Ç –Ω–∞ 8 –∑–∞–Ω—è—Ç–∏–π (‚ÇΩ)</label>
                        <input 
                            type="number" 
                            id="subscription8SeniorPrice" 
                            name="subscription_8_senior_price" 
                            class="form-input" 
                            min="0" 
                            step="100"
                            required
                        >
                        <small class="text-secondary">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Ü–µ–Ω–∞: 3200-3700‚ÇΩ</small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ê–±–æ–Ω–µ–º–µ–Ω—Ç –Ω–∞ 12 –∑–∞–Ω—è—Ç–∏–π (‚ÇΩ)</label>
                        <input 
                            type="number" 
                            id="subscription12SeniorPrice" 
                            name="subscription_12_senior_price" 
                            class="form-input" 
                            min="0" 
                            step="100"
                            required
                        >
                        <small class="text-secondary">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Ü–µ–Ω–∞: 4500-5500‚ÇΩ</small>
                    </div>
                </div>
                
                <h3 class="mb-1">üë∂ –ú–ª–∞–¥—à–∏–µ –≥—Ä—É–ø–ø—ã</h3>
                <div class="grid grid-2 mb-2">
                    <div class="form-group">
                        <label class="form-label">–ê–±–æ–Ω–µ–º–µ–Ω—Ç –Ω–∞ 8 –∑–∞–Ω—è—Ç–∏–π (‚ÇΩ)</label>
                        <input 
                            type="number" 
                            id="subscription8JuniorPrice" 
                            name="subscription_8_junior_price" 
                            class="form-input" 
                            min="0" 
                            step="100"
                            required
                        >
                        <small class="text-secondary">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Ü–µ–Ω–∞: 2800-3200‚ÇΩ</small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">–ê–±–æ–Ω–µ–º–µ–Ω—Ç –Ω–∞ 12 –∑–∞–Ω—è—Ç–∏–π (‚ÇΩ)</label>
                        <input 
                            type="number" 
                            id="subscription12JuniorPrice" 
                            name="subscription_12_junior_price" 
                            class="form-input" 
                            min="0" 
                            step="100"
                            required
                        >
                        <small class="text-secondary">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Ü–µ–Ω–∞: 4000-4500‚ÇΩ</small>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </form>
        </div>
        
        <!-- Info Card -->
        <div class="card">
            <h3>‚ÑπÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</h3>
            <ul style="margin-left: 20px; margin-top: 10px;">
                <li class="mb-1">–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ —Ü–µ–Ω–∞ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ (8 –∏–ª–∏ 12 –∑–∞–Ω—è—Ç–∏–π)</li>
                <li class="mb-1">–í—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ü–µ–Ω—É –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ –≤—Ä—É—á–Ω—É—é</li>
                <li class="mb-1">–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —É–∂–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∞–±–æ–Ω–µ–º–µ–Ω—Ç—ã</li>
                <li class="mb-1">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö —Ç—Ä–µ–Ω–µ—Ä–æ–≤</li>
            </ul>
        </div>
    </main>
    <script src="/static/js/components.js"></script>
    
    <script src="/static/js/app.js"></script>
    <script>
        async function loadData() {
            await auth.checkAuth();
            
            try {
                const user = await api.get('/auth/me');
                document.getElementById('userName').textContent = user.full_name;
                
                // Check if user is admin
                if (!user.is_admin) {
                    ui.showError('–î–æ—Å—Ç—É–ø –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤');
                    setTimeout(() => {
                        window.location.href = '/';
                    }, 2000);
                    return;
                }
                
                // Load current prices
                await loadPrices();
            } catch (error) {
                ui.showError(error.message);
            }
        }
        
        async function loadPrices() {
            try {
                const prices = await api.get('/settings/prices');
                document.getElementById('subscription8SeniorPrice').value = prices.subscription_8_senior_price;
                document.getElementById('subscription12SeniorPrice').value = prices.subscription_12_senior_price;
                document.getElementById('subscription8JuniorPrice').value = prices.subscription_8_junior_price;
                document.getElementById('subscription12JuniorPrice').value = prices.subscription_12_junior_price;
            } catch (error) {
                console.error('Error loading prices:', error);
                ui.showError('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ü–µ–Ω');
            }
        }
        
        document.getElementById('pricesForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const data = {
                subscription_8_senior_price: parseInt(formData.get('subscription_8_senior_price')),
                subscription_12_senior_price: parseInt(formData.get('subscription_12_senior_price')),
                subscription_8_junior_price: parseInt(formData.get('subscription_8_junior_price')),
                subscription_12_junior_price: parseInt(formData.get('subscription_12_junior_price'))
            };
            
            try {
                ui.showLoading();
                await api.put('/settings/prices/update', data);
                ui.hideLoading();
                
                ui.showSuccess('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
            } catch (error) {
                ui.hideLoading();
                ui.showError(error.message);
            }
        });
        
        loadData();
    </script>
</body>
</html>
