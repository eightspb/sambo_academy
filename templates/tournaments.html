{% extends "base.html" %}

{% block title %}Турниры - Sambo Academy{% endblock %}

{% block content %}
        <div class="flex-between mb-2">
            <h1>Турниры</h1>
            <button class="btn btn-primary" onclick="openCreateTournamentModal()">+ Создать турнир</button>
        </div>
        
        <div id="tournamentsList">
            <div class="spinner"></div>
        </div>

<!-- Create Tournament Modal -->
    <div id="createTournamentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Создать турнир</h2>
                <button class="modal-close" onclick="modal.close('createTournamentModal')">&times;</button>
            </div>
            <form id="createTournamentForm">
                <div class="form-group">
                    <label class="form-label">Название турнира</label>
                    <input type="text" name="name" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Дата турнира</label>
                    <input type="date" name="tournament_date" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Место проведения</label>
                    <input type="text" name="location" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Описание</label>
                    <textarea name="description" class="form-textarea" rows="3"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Создать</button>
            </form>
        </div>
    </div>
    
    <!-- Edit Tournament Modal -->
    <div id="editTournamentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Редактировать турнир</h2>
                <button class="modal-close" onclick="modal.close('editTournamentModal')">&times;</button>
            </div>
            <form id="editTournamentForm">
                <input type="hidden" id="editTournamentIdInput">
                <div class="form-group">
                    <label class="form-label">Название турнира</label>
                    <input type="text" name="name" id="editTournamentName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Дата турнира</label>
                    <input type="date" name="tournament_date" id="editTournamentDate" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Место проведения</label>
                    <input type="text" name="location" id="editTournamentLocation" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Описание</label>
                    <textarea name="description" id="editTournamentDescription" class="form-textarea" rows="3"></textarea>
                </div>
                <div class="flex gap-1">
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                    <button type="button" class="btn btn-outline" onclick="modal.close('editTournamentModal')">Отмена</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Add Participant Modal -->
    <div id="addParticipantModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Добавить участника</h2>
                <button class="modal-close" onclick="modal.close('addParticipantModal')">&times;</button>
            </div>
            <form id="addParticipantForm">
                <input type="hidden" id="selectedTournamentId" name="tournament_id">
                
                <div class="form-group">
                    <label class="form-label">Ученик</label>
                    <select name="student_id" id="studentSelect" class="form-select" required></select>
                </div>
                <div class="form-group">
                    <label class="form-label">Место</label>
                    <input type="number" name="place" id="addPlace" class="form-input" min="1">
                </div>
                <div class="form-group">
                    <label class="form-label">Количество схваток</label>
                    <input type="number" name="total_fights" id="addTotalFights" class="form-input" min="0" value="0" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Побед</label>
                    <input type="number" name="wins" id="addWins" class="form-input" min="0" value="0" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Поражений</label>
                    <input type="number" name="losses" id="addLosses" class="form-input" min="0" value="0" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Весовая категория</label>
                    <input type="text" name="weight_category" id="addWeightCategory" class="form-input">
                </div>
                <div class="form-group">
                    <label class="form-label">Примечания</label>
                    <textarea name="notes" id="addNotes" class="form-textarea" rows="2"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Добавить</button>
            </form>
        </div>
    </div>
    
    <!-- Edit Participant Modal -->
    <div id="editParticipantModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Редактировать участника</h2>
                <button class="modal-close" onclick="modal.close('editParticipantModal')">&times;</button>
            </div>
            <form id="editParticipantForm">
                <input type="hidden" id="editTournamentId">
                <input type="hidden" id="editParticipationId">
                
                <div class="form-group">
                    <label class="form-label">Ученик</label>
                    <input type="text" id="editStudentName" class="form-input" readonly>
                </div>
                <div class="form-group">
                    <label class="form-label">Место</label>
                    <input type="number" name="place" id="editPlace" class="form-input" min="1">
                </div>
                <div class="form-group">
                    <label class="form-label">Количество схваток</label>
                    <input type="number" name="total_fights" id="editTotalFights" class="form-input" min="0" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Побед</label>
                    <input type="number" name="wins" id="editWins" class="form-input" min="0" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Поражений</label>
                    <input type="number" name="losses" id="editLosses" class="form-input" min="0" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Весовая категория</label>
                    <input type="text" name="weight_category" id="editWeightCategory" class="form-input">
                </div>
                <div class="form-group">
                    <label class="form-label">Примечания</label>
                    <textarea name="notes" id="editNotes" class="form-textarea" rows="2"></textarea>
                </div>
                <div class="flex gap-1">
                    <button type="submit" class="btn btn-primary">Сохранить</button>
                    <button type="button" class="btn btn-outline" onclick="modal.close('editParticipantModal')">Отмена</button>
                </div>
            </form>
        </div>
    </div>
{% endblock %}

{% block extra_js %}
<script src="/static/js/pages/tournaments.js"></script>
{% endblock %}
