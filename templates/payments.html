<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–ª–∞—Ç–µ–∂–∏ - Sambo Academy</title>
    <link rel="manifest" href="/static/manifest.json">
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="stylesheet" href="/static/css/mobile.css">
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">ü•ã Sambo Academy</div>
            <div class="user-info">
                <span id="userName">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                <button class="btn btn-outline btn-sm" onclick="auth.logout()">–í—ã—Ö–æ–¥</button>
            </div>
        </div>
    </header>
    
    <nav class="nav container">
        <ul class="nav-list">
            <li class="nav-item"><a href="/" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a></li>
            <li class="nav-item"><a href="/groups" class="nav-link">–ì—Ä—É–ø–ø—ã</a></li>
            <li class="nav-item"><a href="/students" class="nav-link">–£—á–µ–Ω–∏–∫–∏</a></li>
            <li class="nav-item"><a href="/attendance" class="nav-link">–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å</a></li>
            <li class="nav-item"><a href="/payments" class="nav-link">–ü–ª–∞—Ç–µ–∂–∏</a></li>
            <li class="nav-item"><a href="/statistics" class="nav-link">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a></li>
            <li class="nav-item"><a href="/tournaments" class="nav-link">–¢—É—Ä–Ω–∏—Ä—ã</a></li>
        </ul>
    </nav>
    
    <main class="container">
        <div class="flex-between mb-2">
            <h1>–ü–ª–∞—Ç–µ–∂–∏ –∏ –∞–±–æ–Ω–µ–º–µ–Ω—Ç—ã</h1>
            <div class="flex gap-1">
                <button class="btn btn-primary" onclick="openCreateSubscriptionModal()">+ –°–æ–∑–¥–∞—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç</button>
                <button class="btn btn-secondary" onclick="openCreatePaymentModal()">+ –î–æ–±–∞–≤–∏—Ç—å –ø–ª–∞—Ç–µ–∂</button>
            </div>
        </div>
        
        <div class="card mb-2">
            <div class="flex gap-2">
                <div class="form-group" style="flex: 1; margin: 0;">
                    <label class="form-label">–ú–µ—Å—è—Ü</label>
                    <input type="month" id="monthFilter" class="form-input" onchange="loadPayments()">
                </div>
            </div>
        </div>
        
        <div id="paymentsList">
            <div class="spinner"></div>
        </div>
    </main>
    
    <!-- Create Subscription Modal -->
    <div id="createSubscriptionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–°–æ–∑–¥–∞—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç</h2>
                <button class="modal-close" onclick="modal.close('createSubscriptionModal')">&times;</button>
            </div>
            <form id="createSubscriptionForm">
                <div class="form-group">
                    <label class="form-label">–£—á–µ–Ω–∏–∫</label>
                    <select name="student_id" id="studentSelect" class="form-select" required></select>
                </div>
                <div class="form-group">
                    <label class="form-label">–¢–∏–ø –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞</label>
                    <select name="subscription_type" id="subscriptionType" class="form-select" required>
                        <option value="8_sessions">8 –∑–∞–Ω—è—Ç–∏–π</option>
                        <option value="12_sessions">12 –∑–∞–Ω—è—Ç–∏–π</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">–¶–µ–Ω–∞</label>
                    <input type="number" name="price" id="subscriptionPrice" class="form-input" step="0.01" required>
                    <small class="text-secondary" id="priceHint"></small>
                </div>
                <div class="form-group">
                    <label class="form-label">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞</label>
                    <input type="date" name="start_date" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è</label>
                    <input type="date" name="expiry_date" class="form-input" required>
                </div>
                <button type="submit" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å</button>
            </form>
        </div>
    </div>
    
    <!-- Create Payment Modal -->
    <div id="createPaymentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–î–æ–±–∞–≤–∏—Ç—å –ø–ª–∞—Ç–µ–∂</h2>
                <button class="modal-close" onclick="modal.close('createPaymentModal')">&times;</button>
            </div>
            <form id="createPaymentForm">
                <div class="form-group">
                    <label class="form-label">–£—á–µ–Ω–∏–∫</label>
                    <select name="student_id" id="studentPaymentSelect" class="form-select" required></select>
                </div>
                <div class="form-group">
                    <label class="form-label">–°—É–º–º–∞</label>
                    <input type="number" name="amount" class="form-input" step="0.01" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–î–∞—Ç–∞ –ø–ª–∞—Ç–µ–∂–∞</label>
                    <input type="date" name="payment_date" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–ó–∞ –∫–∞–∫–æ–π –º–µ—Å—è—Ü</label>
                    <input type="month" name="payment_month" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–¢–∏–ø –ø–ª–∞—Ç–µ–∂–∞</label>
                    <select name="payment_type" class="form-select" required>
                        <option value="full">–ü–æ–ª–Ω–∞—è –æ–ø–ª–∞—Ç–∞</option>
                        <option value="partial">–ß–∞—Å—Ç–∏—á–Ω–∞—è –æ–ø–ª–∞—Ç–∞</option>
                        <option value="discount">–°–æ —Å–∫–∏–¥–∫–æ–π</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">–°—Ç–∞—Ç—É—Å</label>
                    <select name="status" class="form-select" required>
                        <option value="paid">–û–ø–ª–∞—á–µ–Ω–æ</option>
                        <option value="pending">–û–∂–∏–¥–∞–µ—Ç—Å—è</option>
                        <option value="overdue">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
            </form>
    </div>
    
    <script src="/static/js/app.js"></script>
    <script src="/static/js/mobile-nav.js"></script>
    <script src="/static/js/pages/payments.js"></script>
</body>
</html>
