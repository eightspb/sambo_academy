# 💰 Новая страница платежей за абонементы

## ✨ Что изменилось

Полностью переработан интерфейс страницы платежей для удобного управления абонементами по группам.

---

## 🎯 Новый подход

### Старая страница:
- ❌ Нужно создавать абонемент для каждого ученика отдельно
- ❌ Нет общего обзора по группе
- ❌ Сложно увидеть, кто оплатил, а кто нет
- ❌ Неудобно работать с большим количеством учеников

### Новая страница:
- ✅ Выбираешь месяц и группу
- ✅ Видишь ВСЕХ учеников группы в одной таблице
- ✅ Статус оплаты для каждого
- ✅ Быстро отмечаешь оплату
- ✅ Поддержка скидок и переплат
- ✅ Автоматический расчет стандартных цен

---

## 📋 Как работать

### Шаг 1: Выбор месяца и группы

1. Откройте страницу **"Платежи"**
2. Выберите **месяц** (например, октябрь 2025)
3. Выберите **группу** (например, "Старшие ПН-СР-ПТ")
4. Нажмите **"Показать учеников"**

### Шаг 2: Просмотр списка

Вы увидите таблицу со всеми учениками группы:

```
№  | ФИО ученика     | Тип абонемента | Стандартная цена | Фактическая сумма | Статус       | Действия
1  | Чекалев Егор    | 8 занятий      | 3500₽           | -                 | Не оплачено  | [Оплатить]
2  | Сурин Леон      | 8 занятий      | 3500₽           | 3500₽            | Оплачено     | [Детали]
3  | Пыжиков Леонид  | 12 занятий     | 5000₽           | 4500₽ -500₽      | Частично     | [Детали]
```

### Шаг 3: Регистрация оплаты

1. Нажмите кнопку **"Оплатить"** рядом с учеником
2. В открывшемся окне:
   - Выберите **тип абонемента** (8 или 12 занятий)
   - **Стандартная цена** подставится автоматически
   - Введите **фактическую сумму оплаты**
   - Выберите **тип оплаты** (наличные/карта/перевод)
   - Добавьте примечание при необходимости
3. Нажмите **"Сохранить оплату"**

---

## 💡 Особенности

### 🎨 Цветовая индикация

- **Зеленый фон** - ученик оплатил
- **Белый фон** - ученик не оплатил

### 📊 Статусы оплаты

- **Оплачено** (зеленый бейдж) - оплачено полностью
- **Частично** (желтый бейдж) - оплачено меньше стандартной цены
- **Не оплачено** (красный бейдж) - не оплачено

### 💰 Индикаторы разницы

- **+500₽** (зеленый) - переплата
- **-500₽** (красный) - недоплата

### 📈 Статистика

В верхней части страницы отображается сводка:
- **Всего учеников** - количество учеников в группе
- **Оплатили** - сколько учеников оплатили (зеленая цифра)
- **Не оплатили** - сколько не оплатили (красная цифра)

---

## 🔧 Работа со скидками и переплатами

### Скидка для ученика

**Сценарий:** Ученик получил скидку 500₽

1. Стандартная цена: 3500₽
2. Фактическая сумма: **3000₽**
3. Система покажет: `3000₽ -500₽` (красная индикация)
4. Статус: **"Частично"**

### Переплата

**Сценарий:** Родитель оплатил больше

1. Стандартная цена: 3500₽
2. Фактическая сумма: **4000₽**
3. Система покажет: `4000₽ +500₽` (зеленая индикация)
4. Статус: **"Оплачено"**
5. **В будущем:** Переплата автоматически учтется в следующем месяце

---

## 📝 Примеры использования

### Пример 1: Оплата за всю группу

1. Выбираете октябрь 2025 и "Старшие ПН-СР-ПТ"
2. Видите 30 учеников
3. По мере оплаты отмечаете каждого
4. В итоге видите: 28 оплатили, 2 не оплатили

### Пример 2: Скидка для многодетной семьи

1. Открываете оплату для ученика
2. Стандартная цена: 3500₽
3. Меняете на: 3000₽
4. Примечание: "Скидка многодетным 500₽"
5. Сохраняете

### Пример 3: Оплата сразу за 2 месяца

1. Родитель оплатил 7000₽ за 2 месяца
2. В октябре отмечаете: 3500₽
3. В ноябре родитель скажет, что уже оплатил
4. Вы увидите в примечаниях или создадите еще одну оплату

---

## 🎯 Преимущества новой страницы

### ✅ Удобство
- Все ученики группы на одном экране
- Быстрая регистрация оплат
- Наглядная статистика

### ✅ Контроль
- Видно кто не оплатил
- Легко отследить переплаты/недоплаты
- История оплат сохраняется

### ✅ Гибкость
- Индивидуальные цены для каждого
- Поддержка скидок
- Разные типы оплат

### ✅ Автоматизация
- Цены подставляются автоматически
- Учитывается возраст группы
- Расчет переплат/недоплат

---

## 🔄 Миграция со старой страницы

### Старая страница доступна:
**URL:** `/payments-old`

Старая страница сохранена для совместимости. Вы можете использовать её, если нужно.

### Новая страница теперь основная:
**URL:** `/payments`

---

## 🚀 Планы на будущее

### В разработке:

1. **Автоперенос переплаты**
   - Если оплачено больше, автоматически учесть в следующем месяце
   - Показывать остаток от прошлого месяца

2. **Массовые операции**
   - Отметить всех оплативших одной кнопкой
   - Экспорт в Excel

3. **Напоминания**
   - Отправка SMS/Email должникам
   - Уведомления о приближающейся оплате

4. **Детали платежа**
   - Просмотр полной истории оплат
   - Редактирование существующих оплат

---

## 🎨 Интерфейс

### Фильтры
```
┌─────────────────────────────────────┐
│ Фильтры                             │
│ ┌──────────┐  ┌──────────────────┐ │
│ │ 2025-10  │  │ Старшие ПН-СР-ПТ│ │
│ └──────────┘  └──────────────────┘ │
│ [Показать учеников]                 │
└─────────────────────────────────────┘
```

### Статистика
```
┌─────────────────────────────────────┐
│ Итого                               │
│ Всего: 30  Оплатили: 28  Не опл: 2 │
└─────────────────────────────────────┘
```

### Таблица учеников
```
┌──────────────────────────────────────────────────────────┐
│ №  ФИО          Тип      Станд.  Факт.    Статус  Дейст.│
│ 1  Чекалев Егор 8 зан    3500₽   3500₽   ✓       Детали│
│ 2  Сурин Леон   8 зан    3500₽   -        ✗       Оплат │
└──────────────────────────────────────────────────────────┘
```

---

**Готово! Новая страница платежей работает! 💰✨**
