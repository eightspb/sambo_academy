# üéØ Sambo Academy - Production Deployment

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–µ–ø–ª–æ—è –Ω–∞ VPS —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –±—ç–∫–∞–ø–æ–≤ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

## üì¶ –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ VPS –≤ 1 –∫–æ–º–∞–Ω–¥—É
- ‚úÖ –ë—ç–∫–∞–ø –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ Docker Compose —Å Nginx
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ SSL/HTTPS
- ‚úÖ –ì–æ—Ç–æ–≤–∞—è production –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env.production

```bash
cp .env.production .env.production.local
nano .env.production.local

# –ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –∏ —Å–µ–∫—Ä–µ—Ç—ã
SECRET_KEY=$(openssl rand -hex 32)
POSTGRES_PASSWORD=your_strong_password
```

### –®–∞–≥ 2: –î–µ–ø–ª–æ–π

```bash
bash scripts/deploy.sh
```

–í—ã–±–µ—Ä–∏—Ç–µ **"1) –ü–æ–ª–Ω—ã–π –¥–µ–ø–ª–æ–π"** –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞.

### –®–∞–≥ 3: –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```
http://–≤–∞—à-vps-ip:80
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[QUICK_START_DEPLOY.md](QUICK_START_DEPLOY.md)** - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (3 –º–∏–Ω—É—Ç—ã)
- **[DEPLOY.md](DEPLOY.md)** - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é

## üõ†Ô∏è –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

| –°–∫—Ä–∏–ø—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| `scripts/deploy.sh` | –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è |
| `scripts/backup_db.sh` | –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞ –ë–î |
| `scripts/monitor.sh` | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ VPS |
| `scripts/setup_vps.sh` | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VPS —Å –Ω—É–ª—è |

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Production

```
VPS (Ubuntu 22.04)
‚îú‚îÄ‚îÄ Nginx (reverse proxy, SSL)
‚îÇ   ‚îú‚îÄ‚îÄ Port 80 ‚Üí HTTP
‚îÇ   ‚îî‚îÄ‚îÄ Port 443 ‚Üí HTTPS
‚îÇ
‚îú‚îÄ‚îÄ FastAPI App (Docker)
‚îÇ   ‚îî‚îÄ‚îÄ Port 8000
‚îÇ
‚îî‚îÄ‚îÄ PostgreSQL (Docker)
    ‚îî‚îÄ‚îÄ Port 5432 (internal)
```

## üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞

```bash
bash scripts/deploy.sh
# –í—ã–±—Ä–∞—Ç—å: 2) –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î

```bash
bash scripts/deploy.sh
# –í—ã–±—Ä–∞—Ç—å: 4) –¢–æ–ª—å–∫–æ –ë–î
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
bash scripts/monitor.sh
# –í—ã–±—Ä–∞—Ç—å: 2) –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ VPS

```bash
bash scripts/monitor.sh
# –í—ã–±—Ä–∞—Ç—å: 6) –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ VPS (SSH)
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚ö†Ô∏è `.env.production` –≤ `.gitignore` (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è)
- ‚úÖ –ù–∞–¥–µ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è –ë–î
- ‚úÖ SECRET_KEY –¥–ª—è JWT —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ Firewall (UFW) –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ SSL/HTTPS –≥–æ—Ç–æ–≤ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
sambo_academy/
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ backup_db.sh       # –ë—ç–∫–∞–ø –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ deploy.sh          # –î–µ–ø–ª–æ–π
‚îÇ   ‚îú‚îÄ‚îÄ monitor.sh         # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
‚îÇ   ‚îî‚îÄ‚îÄ setup_vps.sh       # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VPS
‚îú‚îÄ‚îÄ nginx/
‚îÇ   ‚îú‚îÄ‚îÄ nginx.conf         # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥
‚îÇ   ‚îî‚îÄ‚îÄ conf.d/
‚îÇ       ‚îî‚îÄ‚îÄ sambo.conf     # –ö–æ–Ω—Ñ–∏–≥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ docker-compose.production.yml
‚îú‚îÄ‚îÄ .env.production        # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥–∞ (–∫–æ–º–º–∏—Ç–∏—Ç—Å—è)
‚îú‚îÄ‚îÄ .env.production.local  # –í–∞—à –∫–æ–Ω—Ñ–∏–≥ (–ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—Å—è)
‚îú‚îÄ‚îÄ DEPLOY.md             # –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ QUICK_START_DEPLOY.md # –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
```

## üéì –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π

```bash
# 1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–æ–ª–∏
nano .env.production

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π
bash scripts/deploy.sh
# ‚Üí 1) –ü–æ–ª–Ω—ã–π –¥–µ–ø–ª–æ–π

# –ì–æ—Ç–æ–≤–æ! –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
```

### –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

```bash
# –ò–∑–º–µ–Ω–∏–ª–∏ –∫–æ–¥ –ª–æ–∫–∞–ª—å–Ω–æ
git add .
git commit -m "Added new feature"
git push

# –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞ VPS
bash scripts/deploy.sh
# ‚Üí 2) –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥
```

### –ë—ç–∫–∞–ø –ë–î –ø–µ—Ä–µ–¥ –≤–∞–∂–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

```bash
# –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø
bash scripts/backup_db.sh

# –û–±–Ω–æ–≤–∏—Ç—å –ë–î
bash scripts/deploy.sh
# ‚Üí 4) –¢–æ–ª—å–∫–æ –ë–î
```

## üåê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
# 1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å DNS
# A –∑–∞–ø–∏—Å—å: your-domain.com ‚Üí –≤–∞—à_VPS_IP

# 2. –ò–∑–º–µ–Ω–∏—Ç—å nginx –∫–æ–Ω—Ñ–∏–≥
ssh your-vps
nano ~/sambo_academy/nginx/conf.d/sambo.conf
# server_name your-domain.com;

# 3. –ü–æ–ª—É—á–∏—Ç—å SSL
sudo certbot --nginx -d your-domain.com

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
cd ~/sambo_academy
docker compose -f docker-compose.production.yml restart nginx
```

## üêõ Troubleshooting

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
bash scripts/monitor.sh
# ‚Üí 2) –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

### –ë–î –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–æ–ª—å –≤ .env.production
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –ë–î
bash scripts/monitor.sh
# ‚Üí 3) –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ –ë–î
```

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ VPS

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSH –≤ .env
cat .env | grep SSH

# –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –≤—Ä—É—á–Ω—É—é
ssh user@vps-ip
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [DEPLOY.md](DEPLOY.md) - —Ä–∞–∑–¥–µ–ª Troubleshooting
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏: `bash scripts/monitor.sh`
3. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ VPS: `bash scripts/monitor.sh` ‚Üí 6

## ‚úÖ Checklist –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] `.env.production` –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å –Ω–∞–¥–µ–∂–Ω—ã–º–∏ –ø–∞—Ä–æ–ª—è–º–∏
- [ ] SSH –¥–æ—Å—Ç—É–ø –∫ VPS —Ä–∞–±–æ—Ç–∞–µ—Ç (—É–∫–∞–∑–∞–Ω –≤ `.env`)
- [ ] –õ–æ–∫–∞–ª—å–Ω–∞—è –ë–î —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- [ ] –ö–æ–¥ –∑–∞–∫–æ–º–º–∏—á–µ–Ω –∏ –∑–∞–ø—É—à–µ–Ω –Ω–∞ GitHub
- [ ] VPS –∏–º–µ–µ—Ç –º–∏–Ω–∏–º—É–º 1GB RAM
- [ ] –û—Ç–∫—Ä—ã—Ç—ã –ø–æ—Ä—Ç—ã 80 –∏ 443

## üöÄ Production Features

- **Multi-worker FastAPI** - 4 worker –ø—Ä–æ—Ü–µ—Å—Å–∞
- **Nginx** - reverse proxy —Å gzip
- **PostgreSQL** - persistent storage
- **Auto-restart** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- **Health checks** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ë–î
- **Logging** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏
- **SSL ready** - –≥–æ—Ç–æ–≤ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ HTTPS

---

**–°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è Sambo Academy**

VPS: `193.42.124.51`  
Repository: `github.com/eightspb/sambo_academy`
